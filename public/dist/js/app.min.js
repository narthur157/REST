angular.module("sampleApp",["ngRoute","appRoutes","MainController","NoteController","FireFactory"]);var app=angular.module("appRoutes",[]);app.config(["$routeProvider","$locationProvider",function(a,b){a.when("/",{templateUrl:"views/home.html",controller:"MainController"}).when("/bears",{templateUrl:"views/bear.html",controller:"BearController"}).when("/notes",{templateUrl:"views/notes.html",controller:"NoteController"}),b.html5Mode(!0)}]);var app=angular.module("MainController",[]);app.controller("MainController",function(){});var app=angular.module("NoteController",["FireFactory"]);app.controller("NoteController",function(a,b){a.school="Binghamton",a.classIdentifier="CS350",a.lecture="aLecture",a.authenticated=!1,a.otherNotes=[];var c=b;c.setup(a.school,a.classIdentifier,a.lecture),a.otherNotes=c.otherNotes,a.login=function(){c.authClient.login("google"),c.authClient&&(a.authenticated=!0)},a.logout=function(){c.authClient.logout(),a.authenticated=!1},a.showNote=function(a){c.getNote(a)}});var app=angular.module("FireFactory",[]);app.factory("FireFactory",function(a){function b(b){var c=a.defer();return d(b.name()).then(function(a){console.log("resolving note"),c.resolve({uid:b.name(),displayName:a,note:b.val()})}),c.promise}function c(){g.lectureRef.on("child_added",function(a){a.name()!==g.user.uid&&b(a).then(function(a){g.otherNotes.push(a)})}),g.userRef=new Firebase(e+"/"+g.user.uid),g.createPad("usersPad",g.user.uid,g.userRef)}function d(b){var c=a.defer();if(!g.lectureRef)throw"LectureRefNull";if(!b)throw"getNameFromIdNullId";return g.rootRef.child("users").startAt().once("value",function(a){a.forEach(function(a){var d=a.val(),e=d.provider+":"+d.provider_id;console.log(e+" : "+b),e===b&&(console.log("resolving name"),c.resolve(d.displayName))})}),c.promise}var e="https://burning-fire-602.firebaseio.com/web/data/",f=null,g={};return g.user=null,g.authClient=null,g.rootRef=null,g.lectureRef=null,g.userRef=null,g.selectedRef=null,g.authClient=null,g.otherNotes=[],g.createPad=function(a,b,c){var d=!1;"usersPad"===a&&(d=!0);var e=document.createElement("div");e.id=a,document.getElementById("contentDiv").appendChild(e);{var f=CodeMirror(document.getElementById(a),{lineWrapping:!0,readOnly:!d});Firepad.fromCodeMirror(c,f,{richTextToolbar:d,richTextShortcuts:d,userId:b})}},g.getNote=function(a){this.selectedRef=new Firebase(e+"/"+this.user.uid),this.createPad(a,a,this.selectedRef)},g.setup=function(a,d,h){f=e+a+"/"+d+"/"+h,this.rootRef=new Firebase(e),this.lectureRef=new Firebase(f),g.authClient=new FirebaseSimpleLogin(this.lectureRef,function(a,d){return a?(console.log(a),null):void(d?(console.log("hello, "+d.displayName),g.rootRef.child("users").child(d.uid).set({displayName:d.displayName,provider:d.provider,provider_id:d.id}),g.lectureRef.startAt().once("value",function(a){a.forEach(function(a){var c=b(a);console.log(c),c.then(function(a){g.otherNotes.push(a),console.log(g.otherNotes)})})}),g.user=d,c()):(console.log("weird stuff happening"),console.log(g.lectureRef)))})},g});